# A.R.C. LiveKit Server Configuration (arc-daredevil-voice)
# ==============================================================================
# High-performance WebRTC SFU for voice-first agentic intelligence
# ==============================================================================

# Port configuration
port: 7880
bind_addresses:
  - '0.0.0.0'

# RTC (Real-Time Communications) configuration
rtc:
  # UDP port range for WebRTC media streams
  # CRITICAL: These ports must be exposed in Docker and open in firewall
  port_range_start: 50000
  port_range_end: 60000

  # Use external IP for local development
  # Set to false in production with proper STUN/TURN configuration
  use_external_ip: true

  # TCP fallback port (when UDP is blocked)
  tcp_port: 7881

  # STUN servers for ICE candidate gathering
  stun_servers:
    - stun.l.google.com:19302

  # Congestion control (modern schema - bandwidth limits moved here)
  congestion_control:
    enabled: true
    # NOTE: min/max bandwidth removed in newer LiveKit versions
    # Use client-side bandwidth estimation instead

# Redis configuration for distributed state management
# MANDATORY: arc-sonic-cache must be running
# NOTE: Can use either 'arc-sonic' (codename) or 'redis' (tech alias)
redis:
  address: arc-sonic:6379
  db: 0
  username: ''
  password: '' # Set via REDIS_PASSWORD env var if needed
  use_tls: false

# API Key/Secret pairs for authentication
# OVERRIDE: Set via LIVEKIT_KEYS environment variable
# Format MUST be "key: secret" (literal string with space after colon)
keys:
  devkey: secret # Note: This is a literal "devkey: secret" string when parsed

# Room configuration
room:
  # Automatically create rooms when participants try to join
  auto_create: true

  # Close empty rooms after 5 minutes
  empty_timeout: 300

  # Maximum participants per room (voice agents count as participants)
  max_participants: 10

  # Departure timeout before removing participant
  departure_timeout: 20

# Logging configuration
logging:
  # Options: debug, info, warn, error
  level: info

  # Sample rate for debug logs (reduce noise)
  sample: false

# NOTE: Prometheus metrics are automatically exposed on /metrics endpoint
# No additional configuration needed for basic metrics collection

# TURN server configuration (for production NAT traversal)
# Uncomment and configure when deploying behind restrictive firewalls
# turn:
#   enabled: true
#   domain: turn.arc.example.com
#   tls_port: 5349
#   udp_port: 3478
#   external_tls: true

# Webhook configuration (optional)
# Send events to external services (e.g., for analytics)
# webhook:
#   urls:
#     - http://arc-analytics:8080/webhook
#   api_key: ${WEBHOOK_API_KEY}

# Region configuration for multi-region deployments (future)
# region: us-west-1

# Node configuration
# node_ip: ""  # Auto-detect

# Development mode settings
# DISABLE IN PRODUCTION
development: false

# Limit configuration (rate limiting)
limit:
  # Bytes per second per participant
  bytes_per_sec: 1000000 # 1 MB/s (generous for voice)


  # NOTE: tracks_per_participant removed in newer LiveKit versions
  # Track limits are now managed via room configuration and participant permissions
