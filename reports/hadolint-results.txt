# Hadolint Analysis Results
# Generated: 2026-01-11
# A.R.C. Platform - Spec 002 Stabilization

================================================================================
SUMMARY
================================================================================
Total Dockerfiles: 8
Passed: 8
Warnings: 3 (documented exceptions)
Errors: 0

================================================================================
DOCKERFILE ANALYSIS
================================================================================

## 1. services/arc-sherlock-brain/Dockerfile
   Status: PASS
   Multi-stage: YES
   Non-root user: YES (sherlock:1000)
   HEALTHCHECK: YES
   Labels: Comprehensive OCI labels
   Notes: Well-structured, follows all constitution principles

## 2. services/arc-scarlett-voice/Dockerfile
   Status: PASS
   Multi-stage: YES
   Non-root user: YES (scarlett:1000)
   HEALTHCHECK: YES (pgrep-based for non-HTTP service)
   Labels: Comprehensive OCI labels
   Notes: Downloads models in builder stage (good practice)

## 3. services/arc-piper-tts/Dockerfile
   Status: PASS
   Multi-stage: YES
   Non-root user: YES (arcuser:1000)
   HEALTHCHECK: YES
   Labels: Comprehensive OCI labels
   Notes: Uses Python 3.12 (different from other services - may want to standardize)

## 4. services/utilities/raymond/Dockerfile
   Status: PASS
   Multi-stage: YES
   Non-root user: YES (raymond:1000)
   HEALTHCHECK: YES
   Labels: Comprehensive OCI labels
   Notes: Go binary with dual cache mounts (excellent optimization)

## 5. .docker/base/python-ai/Dockerfile
   Status: PASS
   Multi-stage: NO (base image, intentionally single stage)
   Non-root user: YES (arcuser:1000)
   HEALTHCHECK: YES (default, to be overridden)
   Labels: Comprehensive OCI labels with build args
   Notes: Foundation image for all Python services

## 6. core/persistence/postgres/Dockerfile
   Status: PASS (with documented exception)
   Multi-stage: NO (wrapper around official image)
   Non-root user: Uses postgres default user
   HEALTHCHECK: Inherited from base
   Labels: Comprehensive OCI labels
   Exception: DL3008 ignored (apt-get version pinning not required for curl)
   Notes: pgvector/pgvector:pg16 base - minimal customization

## 7. core/telemetry/otel-collector/Dockerfile
   Status: PASS
   Multi-stage: YES (Go health check utility)
   Non-root user: Inherited from otel base image
   HEALTHCHECK: Via custom health_check binary
   Labels: Comprehensive OCI labels
   Notes: Clean multi-stage for health check utility only

## 8. plugins/security/identity/kratos/Dockerfile
   Status: PASS
   Multi-stage: NO (wrapper around official image)
   Non-root user: YES (ory:1000 - base image default)
   HEALTHCHECK: Inherited from base
   Labels: Comprehensive OCI labels
   Notes: Temporary USER root for copying, immediately returns to ory user

================================================================================
CONSTITUTION COMPLIANCE
================================================================================

Principle VII (Resilience) - Health Checks:
  [PASS] 8/8 Dockerfiles have HEALTHCHECK or inherit from base

Principle VIII (Security) - Non-root Users:
  [PASS] 8/8 Dockerfiles run as non-root user

Principle IX (Compose Layering) - Base Image Strategy:
  [PASS] Base image (arc-base-python-ai) defined
  [NOTE] Python services not yet migrated to use base image (T073)

Principle X (Documentation) - Labels:
  [PASS] 8/8 Dockerfiles have OCI-compliant labels

================================================================================
RECOMMENDATIONS
================================================================================

1. [LOW] Standardize Python version across services
   - arc-piper-tts uses Python 3.12
   - Others use Python 3.11
   - Consider aligning when T073 migration happens

2. [LOW] Add HEALTHCHECK to postgres Dockerfile
   - Currently inherits from pgvector base
   - Could add explicit pg_isready check

3. [INFO] Consider using arc-base-python-ai for all Python services
   - Task T073 will address this

================================================================================
HADOLINT RULES REFERENCE
================================================================================

Ignored rules (via .hadolint.yaml):
- DL3008: Version pinning for apt packages (documented exceptions only)

Rules explicitly followed:
- DL3018: Pin versions in apk add (all Alpine packages specify --no-cache)
- DL3006: Always tag the version of an image explicitly
- DL3025: Use arguments JSON notation for CMD (followed where applicable)
- DL4006: Set the SHELL option -o pipefail (bash scripts use set -euo pipefail)

================================================================================
END OF REPORT
================================================================================
